!function(){angular.module("GhstsViewer",["pasvaz.bindonce","ui.bootstrap","ui.layout","ghsts-document-list","ghsts-document-table","ghsts-file-list","ghsts-model","ghsts-controller-menu","ghsts-controller-filter","ghsts-controller-toc","ghsts-controller-structure","ghsts-detail-controllers","ghsts-state-service","ghsts-filter-service","cfp.hotkeys"])}(),function(){var a=angular.module("ghsts-constants",[]);/*
    * These contain global constants
    */
a.constant("CONFIG",{VIEWER_VERSION:"01.00.00",PDFJS_VERSION:"1.1.1",PDFJS_FILE_PATH:"pdfjs/viewer.html?file=",
// Path to submission folder & file
// this will be replaced during build
// SUBMISSION_ROOT: 'sample_submissions/GHSTS2015-UI/04/',
// SUBMISSION_FILE: 'sample_submissions/GHSTS2015-UI/04/ghsts.xml'
SUBMISSION_ROOT:"../../",SUBMISSION_FILE:"../../ghsts.xml"})}(),function(){var a=angular.module("DataAccess",["ghsts-constants"]);a.factory("DataAccessFactory",["CONFIG",function(a){var b=this;return b.xmlData={},console.log("Start XML load: "+Date.now()),$.ajax({url:a.SUBMISSION_FILE,async:!1,dataType:"text",type:"GET",success:function(a){console.log("Finished XML load: "+Date.now()),b.xmlData=$(a),console.log("Finished XML jquery load: "+Date.now())},error:function(a){alert("Error loading file!"),console.log("ERROR: [GHSTS Viewer] failed to load XML Dossier: "),console.log(a)}}),{getData:function(){return b.xmlData}}}])}(),function(){var a=angular.module("ghsts-model",["DataAccess"]);a.service("GhstsModelData",["DataAccessFactory",function(a){
// find the next or previous element by ID in a given document or file list
function b(a,b,d,e){
// go through all documents
for(var f=d.length,g=0;f>g;g++)
// if current document found
if(d[g].Id===b){
// identify potential next (in list)
var h=g,i=h;do if(e?(i--,0>i&&(i=f-1)):(i++,i>=f&&(i=0)),d[i].isVisible)return a?c.resolveDocument(d[i].Id):c.resolveFile(d[i].Id);while(i!==h);break}
// there is no visible list item
return null}var c=this;c.xmlData={},c.ViewModel={},this.getSubmissionPath=function(a,b){
// 0. the location is an an URL -> decode
a=decodeURIComponent(a),
// 1. remove file protocol
0===a.indexOf("file:///")&&(a=a.replace("file:///",""));
// 2. remove everything behind first #
var c=a.indexOf("#");c>=0&&(a=a.substring(0,c));
// 3. remove everything behind last /
var d=a.lastIndexOf("/");
// 4. move directories up - as many as given
if(d>=0&&(a=a.substring(0,d+1)),b){for(;b>0;b--){var e=a.lastIndexOf("/");if(!(e>=0))break;a=a.substring(0,e)}a+="/"}return a},
// pre-generate ViewModel
c.generateViewModel=function(){"undefined"==typeof c.ViewModel&&(c.ViewModel={}),this.generateLEGAL_ENTITIES(),this.generateRECEIVERS(),this.generateSUBSTANCES(),this.generatePRODUCT(),this.generateDOSSIER(),this.generateFILES(),this.generateDOCUMENTS(),this.generateFILELIST(),this.generateDOCLIST(),this.generateFILTER(),this.generateTOC(),this.generateTREE(),this.generateINFO()},c.generateLEGAL_ENTITIES=function(){"undefined"==typeof c.ViewModel.LEGAL_ENTITIES&&(c.ViewModel.LEGAL_ENTITIES={});for(var a=[],b=$("LEGAL_ENTITIES LEGAL_ENTITY",c.xmlData),d=0;d<b.length;d++){var e=$(b[d]),f={};f=c.mapOneToOne(e,["LEGALENTITY_PID","LEGALENTITY_NAME"]),f.OTHER_NAME=c.makeArray(e.children("OTHER_NAME")),f._Id=e.attr("Id"),f.METADATA_STATUS=c.getValue(e.children("METADATA_STATUS"),!1),f.LEGALENTITY_TYPE=c.getValue(e.children("LEGALENTITY_TYPE"),!0),f.LEGALENTITY_IDENTIFIER=[];var g=e.children("LEGALENTITY_IDENTIFIER");if(g&&g.length>0)for(var h=0;h<g.length;h++){var i=$(g[h]),j={};j.LEGALENTITY_IDENTIFIER_TYPE=c.getValue(i.children("LEGALENTITY_IDENTIFIER_TYPE"),!0),j.IDENTIFIER=i.children("IDENTIFIER"),f.LEGALENTITY_IDENTIFIER.push(j)}f.CONTACT_ADDRESS={},f.CONTACT_ADDRESS=c.mapOneToOne(e.children("CONTACT_ADDRESS"),["STREET1","STREET2","ZIPCODE","CITY","STATE","PHONE","FAX","EMAIL","WEBSITE"]),f.CONTACT_ADDRESS.COUNTRY=c.getValue(e.children("CONTACT_ADDRESS").children("COUNTRY"),!0),f.CONTACT_PERSON=[];var k=e.children("CONTACT_PERSON");if(k&&k.length>0)for(var h=0;h<k.length;h++){var l=$(k[h]),m={};m=c.mapOneToOne(l,["ORGANISATION","DEPARTMENT","TITLE","FIRSTNAME","LASTNAME","PHONE","MOBILE","FAX","EMAIL"]),f.CONTACT_PERSON.push(m)}a.push(f)}c.ViewModel.LEGAL_ENTITIES=a},c.generateRECEIVERS=function(){"undefined"==typeof c.ViewModel.RECEIVERS&&(c.ViewModel.RECEIVERS={});for(var a=[],b=$("RECEIVERS RECEIVER",c.xmlData),d=0;d<b.length;d++){var e=$(b[d]),f={};f=c.mapOneToOne(e,["SHORT_NAME","ROLE"]),f._Id=e.attr("Id"),f.REF_RA_Id=f._Id,f.forRA=[],f.forRA.push(f._Id),f.METADATA_STATUS=c.getValue(e.children("METADATA_STATUS"),!1),f.REF_LE_Id=c.getReferences(e,"To_Legal_Entity_Id"),f.LEGAL_ENTITY=c.resolveLegalEntity(f.REF_LE_Id),f.SENDER=[];for(var g=[],h=e.children("SENDER"),i=0;i<h.length;i++){var j=$(h[i]),k={};k=c.mapOneToOne(j,["COMPANY_CONTACT_REGULATORY_ROLE","REMARK"]),k.REF_LE_Id=c.getReferences(j,"To_Legal_Entity_Id"),k.LEGAL_ENTITY=c.resolveLegalEntity(k.REF_LE_Id),g.push(k)}f.SENDER=g,a.push(f)}c.ViewModel.RECEIVERS=a},c.generateSUBSTANCES=function(){"undefined"==typeof c.ViewModel.SUBSTANCES&&(c.ViewModel.SUBSTANCES={});for(var a=[],b=$("SUBSTANCES SUBSTANCE",c.xmlData),d=0;d<b.length;d++){var e=$(b[d]),f={};f=c.mapOneToOne(e,["SUBSTANCE_PID","SUBSTANCE_NAME"]),f._Id=e.attr("Id"),f.METADATA_STATUS=c.getValue(e.children("METADATA_STATUS"),!1),f.SUBSTANCE_IDENTIFIER=[];var g=e.children("SUBSTANCE_IDENTIFIER");if(g&&g.length>0)for(var h=0;h<g.length;h++){var i=$(g[h]),j={};j.SUBSTANCE_IDENTIFIER_TYPE=c.getValue(i.children("SUBSTANCE_IDENTIFIER_TYPE"),!0),j.IDENTIFIER=i.children("IDENTIFIER").text(),f.SUBSTANCE_IDENTIFIER.push(j)}a.push(f)}c.ViewModel.SUBSTANCES=a},c.generatePRODUCT=function(){"undefined"==typeof c.ViewModel.PRODUCT&&(c.ViewModel.PRODUCT={});var a=$("PRODUCT",c.xmlData),b=$(a),d={};d=c.mapOneToOne(b,["PRODUCT_PID","GENERIC_PRODUCT_NAME"]),d.METADATA_STATUS=c.getValue(b.children("METADATA_STATUS"),!1),d.FORMULATION_TYPE=c.getValue(b.children("FORMULATION_TYPE"),!0),d.PRODUCT_RA=[];for(var e=$("PRODUCT_RA",b),f=[],g=0;g<e.length;g++){var h=$(e[g]),i={};i=c.mapOneToOne(h,["PRODUCT_NAME"]),i.REF_RA_Id=c.getReferences(h,"To_Specific_for_RA_Id"),i.forRA=[],i.forRA.push(i.REF_RA_Id),i.RA=c.resolveReceiver(i.REF_RA_Id),i.ADMIN_NUMBER=[];for(var j=[],k=$("ADMIN_NUMBER",h),l=0;l<k.length;l++){var m=$(k[l]),n={};n=c.mapOneToOne(m,["IDENTIFIER"]),n.ADMIN_NUMBER_TYPE=c.getValue(m.children("ADMIN_NUMBER_TYPE"),!0),j.push(n)}i.ADMIN_NUMBER=j,f.push(i)}d.PRODUCT_RA=f,d.INGREDIENTS=[];for(var o=$("INGREDIENTS INGREDIENT",b),p=[],l=0;l<o.length;l++){var q=$(o[l]),r={};r=c.mapOneToOne(q,["QUANTITY"]),r.UNIT=c.getValue(q.children("UNIT"),!0),r.REF_SB_Id=c.getReferences(q,"To_Substance_Id"),r.SUBSTANCE=c.resolveSubstance(r.REF_SB_Id),p.push(r)}d.INGREDIENTS=p,c.ViewModel.PRODUCT=d},c.generateDOSSIER=function(){"undefined"==typeof c.ViewModel.DOSSIER&&(c.ViewModel.DOSSIER={});var a=$("PRODUCT DOSSIER",c.xmlData),b=$(a),d={};d=c.mapOneToOne(b,["DOSSIER_PID","DOSSIER_DESCRIPTION_TITLE","DOSSIER_COMP_ID"]),d.REFERENCED_DOSSIER=[];for(var e=[],f=$("REFERENCED_DOSSIER",b),g=0;g<f.length;g++){var h=$(f[g]),i={};i=c.mapOneToOne(h,["REFERENCED_DOSSIER_NUMBER","REFERENCED_DOSSIER_REASON"]),e.push(i)}d.REFERENCED_DOSSIER=e,d.DOSSIER_RA=[];for(var j=$("DOSSIER_RA",b),k=[],g=0;g<j.length;g++){var l=$(j[g]),m={};m.REF_RA_Id=c.getReferences(l,"To_Specific_for_RA_Id"),m.forRA=[],m.forRA.push(m.REF_RA_Id),m.RA=c.resolveReceiver(m.REF_RA_Id),m.REGULATORY_TYPE=c.getValue(l.children("REGULATORY_TYPE"),!0),m.APPLICATION_TYPE=c.getValue(l.children("APPLICATION_TYPE"),!0),m.PROJECT_ID_NUMBER=c.makeArray(l.children("PROJECT_ID_NUMBER")),k.push(m)}d.DOSSIER_RA=k,d.SUBMISSIONS=[];for(var n=$("SUBMISSION",b),o=[],g=0;g<n.length;g++){var p=$(n[g]),q={};q=c.mapOneToOne(p,["SUBMISSION_NUMBER","SUBMISSION_VERSION_DATE","SUBMISSION_TITLE","INCREMENTAL"]),o.push(q)}d.SUBMISSIONS=o,c.ViewModel.DOSSIER=d,c.ViewModel.DOSSIER.CurrentSubmission=this.padZero(this.getCurrentSubmission(),2)},c.generateFILES=function(){"undefined"==typeof c.ViewModel.FILES&&(c.ViewModel.FILES={});for(var a=[],b=$("FILES FILE",c.xmlData),d=0;d<b.length;d++){var e=$(b[d]),f={};f._Id=e.attr("Id"),f.FILE_GENERIC={};var g=$("FILE_GENERIC",e),h=$(g),i={};i=c.mapOneToOne(h,["FILE_PID","FILE_COMPANY_ID","REPLACED_FILE_PID","FORMAT_COMMENT","MD5CHECKSUM","FILENAME"]),i.METADATA_STATUS=c.getValue(h.children("METADATA_STATUS"),!1),i.FILE_TYPE=c.getValue(h.children("FILE_TYPE"),!0),i.CONTENT_STATUS=c.getValue(h.children("CONTENT_STATUS"),!0),f.FILE_GENERIC=i,f.FILE_RA={};for(var j=$("FILE_RA",e),k=[],l=0;l<j.length;l++){var m=$(j[l]),n={};n=c.mapOneToOne(m,["CBI_DESIGNATION","FILE_COMMENT"]),n.REF_RA_Id=c.getReferences(m,"To_Specific_for_RA_Id"),n.forRA=[],n.forRA.push(n.REF_RA_Id),n.RA=c.resolveReceiver(n.REF_RA_Id),n.METADATA_STATUS=c.getValue(m.children("METADATA_STATUS"),!1),k.push(n)}f.FILE_RA=k,a.push(f)}c.ViewModel.FILES=a},c.generateDOCUMENTS=function(){"undefined"==typeof c.ViewModel.DOCUMENTS&&(c.ViewModel.DOCUMENTS={});for(var a=$("DOCUMENTS DOCUMENT",c.xmlData),b=[],d=0;d<a.length;d++){var e=$(a[d]),f={};f._Id=e.attr("Id"),f.DOCUMENT_GENERIC={};var g=$("DOCUMENT_GENERIC",e),h=$(g),i={};i=c.mapOneToOne(h,["DOCUMENT_PID","DOCUMENT_FAMILY_PID","DOCUMENT_FAMILY","DOCUMENT_TITLE","DOCUMENT_AUTHOR","DOCUMENT_ISSUE_DATE","PUBLISHED_INDICATOR","GXP_INDICATOR","TESTED_ON_VERTEBRATE","COMPLETE_DOCUMENT_SOURCE","DOCUMENT_SOURCE","DOCUMENT_YEAR","DOCUMENT_ISSUE","DOCUMENT_VOLUME","DOCUMENT_PAGES"]),i.METADATA_STATUS=c.getValue(h.children("METADATA_STATUS"),!1),i.DOCUMENT_OWNER=c.makeArray(h.children("DOCUMENT_OWNER")),i.TEST_LABORATORY=c.makeArray(h.children("TEST_LABORATORY")),
// CONTENT_STATUS_HISTORY
i.CONTENT_STATUS_HISTORY={};for(var j=[],k=h.children("CONTENT_STATUS_HISTORY").children(),l=0;l<k.length;l+=2){var m=$(k[l]),n=$(k[l+1]),o={};o.SUBMISSION_NUMBER=n.text(),o.CONTENT_STATUS=c.getValue(m,!0),j.push(o)}i.CONTENT_STATUS_HISTORY=j,i.currentStatus=this.getCurrentStatus(i.CONTENT_STATUS_HISTORY,c.ViewModel.DOSSIER.CurrentSubmission),/*
                docGeneric['DOCUMENT_SOURCE'] = {};
                var DOCUMENT_SOURCE = $("DOCUMENT_SOURCE", $DOCUMENT_GENERIC);
                var $DOCUMENT_SOURCE = $(DOCUMENT_SOURCE);
                docGeneric['DOCUMENT_SOURCE'] = self.mapOneToOne($DOCUMENT_SOURCE, ["DOCUMENT_YEAR", "DOCUMENT_ISSUE", "DOCUMENT_VOLUME", "DOCUMENT_PAGES"]);
                */
// will be filled later when TREE is generated
i.toc_refs=[],i.REFERENCED_DOCUMENT=[];for(var p=[],q=$("REFERENCED_DOCUMENT",h),l=0;l<q.length;l++){var r=$(q[l]),s={};s=c.mapOneToOne(r,["INTERNAL","DOCUMENT_PID"]),s.REFERENCE_TYPE=c.getValue(r.children("REFERENCE_TYPE"),!0),s.DOCUMENT_NUMBER={};var t={},u=$("DOCUMENT_NUMBER",r);if(u||u.length>0){var v=$(u);t=c.mapOneToOne(v,["IDENTIFIER"]),t.DOCUMENT_NUMBER_TYPE=c.getValue(v.children("DOCUMENT_NUMBER_TYPE"),!0)}s.DOCUMENT_NUMBER=t,p.push(s)}i.REFERENCED_DOCUMENT=p,i.DOCUMENT_NUMBER=[];for(var w=[],x=h.children("DOCUMENT_NUMBER"),l=0;l<x.length;l++){var v=$(x[l]),y={};y=c.mapOneToOne(v,["IDENTIFIER"]),y.DOCUMENT_NUMBER_TYPE=c.getValue(v.children("DOCUMENT_NUMBER_TYPE"),!0),w.push(y)}i.DOCUMENT_NUMBER=w,i.RELATED_TO_SUBSTANCE=[];for(var z=$("RELATED_TO_SUBSTANCE",h),A=[],l=0;l<z.length;l++){var B=$(z[l]),C={};C.REF_SB_Id=c.getReferences(B,"To_Substance_Id"),C.SUBSTANCE=c.resolveSubstance(C.REF_SB_Id),A.push(C)}i.RELATED_TO_SUBSTANCE=A,i.REFERENCED_TO_FILE={},i.confidentialForRA=[];for(var D=$("REFERENCED_TO_FILE",h),E=[],l=0;l<D.length;l++){var F=$(D[l]),G={};G.REF_FL_Id=c.getReferences(F,"To_File_Id"),G.FILE=c.resolveFile(G.REF_FL_Id),E.push(G),
// main file?
"Main"===G.FILE.FILE_GENERIC.FILE_TYPE&&(i.MAIN_FILE_PATH=G.FILE.FILE_GENERIC.FILENAME,i.MAIN_FILE_ID=G.FILE.FILE_GENERIC._Id);
// for each RA entry in FILE
for(var H=0;H<G.FILE.FILE_RA.length;H++)"true"===G.FILE.FILE_RA[H].CBI_DESIGNATION&&-1==i.confidentialForRA.indexOf(G.FILE.FILE_RA[H].REF_RA_Id)&&i.confidentialForRA.push(G.FILE.FILE_RA[H].REF_RA_Id)}i.REFERENCED_TO_FILE=E,f.DOCUMENT_GENERIC=i,f.DOCUMENT_RA={};for(var I=$("DOCUMENT_RA",e),J=[],l=0;l<I.length;l++){var K=$(I[l]),L={};L.REF_RA_Id=c.getReferences(K,"To_Specific_for_RA_Id"),L.forRA=[],L.forRA.push(L.REF_RA_Id),L.RA=c.resolveReceiver(L.REF_RA_Id),L.METADATA_STATUS=c.getValue(K.children("METADATA_STATUS"),!1),L.DATA_PROTECTION=c.getValue(K.children("DATA_PROTECTION"),!0),L.DATA_REQUIREMENT=c.getValue(K.children("DATA_REQUIREMENT"),!0),L.DOCUMENT_COMMENT=c.makeArray(K.children("DOCUMENT_COMMENT")),L.OTHER_NATIONAL_GUIDELINE={};for(var M=[],N=$("OTHER_NATIONAL_GUIDELINE",K),H=0;H<N.length;H++){var O=$(N[H]),P={};P=c.mapOneToOne(O,["GUIDELINE_SYSTEM","GUIDELINE_NUMBER"]),M.push(P)}L.OTHER_NATIONAL_GUIDELINE=M,L.RA_DOCUMENT_NUMBER={};var Q=$("RA_DOCUMENT_NUMBER",K),R=$(Q),S={};S=c.mapOneToOne(R,["IDENTIFIER","ALREADY_SUBMITTED"]),S.RA_DOCUMENT_NUMBER_TYPE=c.getValue(R.children("RA_DOCUMENT_NUMBER_TYPE"),!0),S.SUBMISSION_CONTEXT={};for(var T=$("SUBMISSION_CONTEXT",R),U=[],H=0;H<T.length;H++){var V=$(T[H]),W={};W=c.mapOneToOne(V,["DOSSIER_PID","DOSSIER_NUMBER"]),U.push(W)}S.SUBMISSION_CONTEXT=U,L.RA_DOCUMENT_NUMBER=S,
// RA-specific FILE Information
L.FILEINFO={};for(var X=[],H=0;H<f.DOCUMENT_GENERIC.REFERENCED_TO_FILE.length;H++){
// get the data needed to resolve FileRA information
var Y=f.DOCUMENT_GENERIC.REFERENCED_TO_FILE[H].FILE,Z=L.REF_RA_Id,_=this.resolveFileInfoPerRA(Y,Z),aa={};if(_){
// get RA specific information
aa.cbi="true"===_.CBI_DESIGNATION?!0:!1,aa.comment=_.FILE_COMMENT,
// get RA-independent information
aa.filetype=Y.FILE_GENERIC.FILE_TYPE;var ba=Y.FILE_GENERIC.FILENAME;aa.filepath=ba,aa.shortfilename=ba.substr(ba.lastIndexOf("/")+1),aa.mimetype=aa.shortfilename.substr(aa.shortfilename.lastIndexOf(".")+1),aa.companyid=Y.FILE_GENERIC.FILE_COMPANY_ID,aa.replacedfilepid=Y.FILE_GENERIC.REPLACED_FILE_PID,aa.formatcomment=Y.FILE_GENERIC.FORMAT_COMMENT,aa.pid=Y.FILE_GENERIC.FILE_PID,aa.replacedpid=Y.FILE_GENERIC.REPLACED_FILE_PID,aa.status=Y.FILE_GENERIC.CONTENT_STATUS,X.push(aa)}}L.FILEINFO=X,J.push(L)}f.DOCUMENT_RA=J,b.push(f)}c.ViewModel.DOCUMENTS=b},c.generateDOCLIST=function(){"undefined"==typeof c.ViewModel.DOCLIST&&(c.ViewModel.DOCLIST={});for(var a=[],b=0;b<c.ViewModel.DOCUMENTS.length;b++){var d=c.ViewModel.DOCUMENTS[b],e={};e=c.copyByValue(d.DOCUMENT_GENERIC,["METADATA_STATUS","DOCUMENT_TITLE","DOCUMENT_AUTHOR","DOCUMENT_ISSUE_DATE","PUBLISHED_INDICATOR","GXP_INDICATOR","TESTED_ON_VERTEBRATE","DOCUMENT_NUMBER","TEST_LABORATORY","DOCUMENT_OWNER","COMPLETE_DOCUMENT_SOURCE","DOCUMENT_SOURCE","DOCUMENT_YEAR","DOCUMENT_ISSUE","DOCUMENT_VOLUME","DOCUMENT_PAGES"]),e.Id=d._Id,e.forRA=[];for(var f=0;f<d.DOCUMENT_RA.length;f++)e.forRA.push(d.DOCUMENT_RA[f].REF_RA_Id);e.name=e.DOCUMENT_TITLE,e.confidentialForRA=d.DOCUMENT_GENERIC.confidentialForRA,e.currentStatus=d.DOCUMENT_GENERIC.currentStatus,e.retired="Retired"===e.currentStatus?!0:!1,e.lastChange=this.getLastChange(d.DOCUMENT_GENERIC.CONTENT_STATUS_HISTORY),e.toc_refs=[],a.push(e)}c.ViewModel.DOCLIST=a},c.generateFILELIST=function(){"undefined"==typeof c.ViewModel.FILELIST&&(c.ViewModel.FILELIST={});for(var a=[],b=0;b<c.ViewModel.FILES.length;b++){var d=c.ViewModel.FILES[b],e={};e.path=d.FILE_GENERIC.FILENAME,e.filename=e.path.substr(e.path.lastIndexOf("/")+1),e.Id=d._Id,e.forRA=[],e.confidentialForRA=[];for(var f=0;f<c.ViewModel.FILES[b].FILE_RA.length;f++)e.forRA.push(c.ViewModel.FILES[b].FILE_RA[f].REF_RA_Id),"true"===c.ViewModel.FILES[b].FILE_RA[f].CBI_DESIGNATION&&e.confidentialForRA.push(c.ViewModel.FILES[b].FILE_RA[f].REF_RA_Id);e.name=e.filename,a.push(e)}c.ViewModel.FILELIST=a},c.generateFILTER=function(){"undefined"==typeof c.ViewModel.FILTER&&(c.ViewModel.FILTER={});for(var a=[],b=$("RECEIVERS RECEIVER",c.xmlData),d=0;d<b.length;d++){var e=$(b[d]),f={};f.Id=e.attr("Id"),f.Name=e.children("SHORT_NAME").text(),a.push(f)}for(var g=[],h=$("PRODUCT DOSSIER SUBMISSION",c.xmlData),d=1;d<h.length;d++){var i=$(h[d]),j="";j=i.children("SUBMISSION_NUMBER").text(),g.push(j)}c.ViewModel.FILTER.RAs=a,c.ViewModel.FILTER.Submissions=g},c.generateTOC=function(){function a(a){var b={};return b=c.mapOneToOne(a,["NODE_NAME","NODE_HEADING","LOGICAL_DELETED","TOC_NODE_PID","EMPTY_NODE"])}function b(a){for(var b=[],d=a.children("TOC2DOC"),e=0;e<d.length;e++){var f=$(d[e]),g={};g.REF_DOC_Id=f.attr("To_Document_Id"),g.document=c.resolveDocument(g.REF_DOC_Id),b.push(g)}return b}function d(c){for(var g=[],h=c.children("TOC_NODE"),i=0;i<h.length;i++){var j=$(h[i]),k={};k=a(j),k.TOC_NODE=[],k.TOC_NODE=d(j),k.TOC2DOC=[],k.TOC2DOC=b(j),g.push(k),f[e]={},f[e].nodename=k.NODE_NAME,f[e].docs=[];for(var l=0;l<k.TOC2DOC.length;l++)f[e].docs.push(k.TOC2DOC[l].document._Id);e++}return g}"undefined"==typeof c.ViewModel.TOC&&(c.ViewModel.TOC={});var e=0,f=[],g=$("TOC",c.xmlData),h=$(g),i={};i=c.mapOneToOne(h,["TOC_SHORT_NAME","TOC_FULL_NAME","TOC_VERSION"]),i.METADATA_STATUS=c.getValue(h.children("METADATA_STATUS"),!1),i.TOC_OWNER=c.getValue(h.children("TOC_OWNER"),!0),i.STANDARD_TOC_REFERENCE={},i.STANDARD_TOC_REFERENCE=c.mapOneToOne(h.children("STANDARD_TOC_REFERENCE"),["STANDARD_TOC_PID","FILENAME"]),i.STRUCTURE={},i.INDEX={};var j=$(h.children("STRUCTURE")),k=d(j);i.STRUCTURE=k,i.INDEX=f,c.ViewModel.TOC=i},c.generateTREE=function(){function a(e){for(var f=[],g=0;g<e.length;g++){var h={};h.type="NODE",h.id=e[g].TOC_NODE_PID,h.nodeIndex=d++,h.title=e[g].NODE_HEADING,h.name=e[g].NODE_NAME,h.children=[],h.children=a(e[g].TOC_NODE);for(var i=0;i<e[g].TOC2DOC.length;i++){var j={};j.type="DOC",j.docIndex=b++,j.nodeIndex=d++,j.id=e[g].TOC2DOC[i].REF_DOC_Id;var k=c.resolveDocument(j.id);k.DOCUMENT_GENERIC.toc_refs.push({name:h.name,id:j.id,index:j.docIndex});var l=c.resolveDocumentInList(j.id);l.toc_refs.push({name:h.name,id:j.id,index:j.docIndex}),j.title=e[g].TOC2DOC[i].document.DOCUMENT_GENERIC.DOCUMENT_AUTHOR+" ("+e[g].TOC2DOC[i].document.DOCUMENT_GENERIC.DOCUMENT_ISSUE_DATE+")",j.name=e[g].TOC2DOC[i].document.DOCUMENT_GENERIC.DOCUMENT_TITLE,
// filter attributes
j.parentName=h.name,j.ISSUE_DATE=e[g].TOC2DOC[i].document.DOCUMENT_GENERIC.DOCUMENT_ISSUE_DATE,j.DOCUMENT_NUMBER=e[g].TOC2DOC[i].document.DOCUMENT_GENERIC.DOCUMENT_NUMBER,j.DOCUMENT_AUTHOR=e[g].TOC2DOC[i].document.DOCUMENT_GENERIC.DOCUMENT_AUTHOR,j.DOCUMENT_OWNER=e[g].TOC2DOC[i].document.DOCUMENT_GENERIC.DOCUMENT_OWNER,j.TEST_LABORATORY=e[g].TOC2DOC[i].document.DOCUMENT_GENERIC.TEST_LABORATORY,
// SOURCE info
j.COMPLETE_DOCUMENT_SOURCE=e[g].TOC2DOC[i].document.DOCUMENT_GENERIC.COMPLETE_DOCUMENT_SOURCE,j.DOCUMENT_YEAR=e[g].TOC2DOC[i].document.DOCUMENT_GENERIC.DOCUMENT_YEAR,j.DOCUMENT_ISSUE=e[g].TOC2DOC[i].document.DOCUMENT_GENERIC.DOCUMENT_ISSUE,j.DOCUMENT_VOLUME=e[g].TOC2DOC[i].document.DOCUMENT_GENERIC.DOCUMENT_VOLUME,j.DOCUMENT_PAGES=e[g].TOC2DOC[i].document.DOCUMENT_GENERIC.DOCUMENT_PAGES,j.forRA=[];for(var m=0;m<e[g].TOC2DOC[i].document.DOCUMENT_RA.length;m++)j.forRA.push(e[g].TOC2DOC[i].document.DOCUMENT_RA[m].REF_RA_Id);j.confidentialForRA=e[g].TOC2DOC[i].document.DOCUMENT_GENERIC.confidentialForRA,j.currentStatus=e[g].TOC2DOC[i].document.DOCUMENT_GENERIC.currentStatus,j.retired="Retired"===j.currentStatus?!0:!1,j.lastChange=c.getLastChange(e[g].TOC2DOC[i].document.DOCUMENT_GENERIC.CONTENT_STATUS_HISTORY),j.children=[],h.children.push(j)}
// tweak to display emtpy nodes as folder, not as document in Tree View
0===h.children.length&&(h.children={}),f.push(h)}return f}"undefined"==typeof c.ViewModel.TREE&&(c.ViewModel.TREE={});var b=0,d=0,e=[],f={};
// we don't need a title as the short name is sufficient for the name
f.title=c.ViewModel.TOC.TOC_FULL_NAME,//self.ViewModel.TOC.TOC_SHORT_NAME;
f.name=c.ViewModel.TOC.TOC_SHORT_NAME,f.type="TOC",f.nodeIndex=d++,f.children=a(c.ViewModel.TOC.STRUCTURE),e.push(f),e.nodeCount=d,e.docCount=b,c.ViewModel.TREE=e},c.generateINFO=function(){"undefined"==typeof c.ViewModel.INFO&&(c.ViewModel.INFO={});var a={};a.submission=c.ViewModel.DOSSIER.CurrentSubmission,a.currentpath=c.getSubmissionPath(window.location.href,3)+"ghsts.xml",a.specversion=c.xmlData.filter(":first").attr("specificationversion"),a.shortname=c.ViewModel.TOC.TOC_SHORT_NAME,a.tocversion=c.ViewModel.TOC.TOC_VERSION,a.tocstatus=c.ViewModel.TOC.METADATA_STATUS,
// TODO the accessing of parent.viewerAPI results in violations to same origin policy
// if (typeof parent.viewerAPI != "undefined") {
//     info.nwversion = parent.viewerAPI.getVersions().nodeWebkit;
//     info.viewerversion = parent.viewerAPI.getVersions().desktopViewer;
// }
// else {
a.nwversion="not available",a.viewerversion="not available",
// }
a.angularversion=angular.version,a.jqueryversion=jQuery.fn.jquery,c.ViewModel.INFO=a},
// HELPER functions
this.mapOneToOne=function(a,b){if(!a)return[];if(!b||0===b.length)return[];for(var c={},d=0;d<b.length;d++){var e=b[d],f=a.children(e),g=f&&0!==f.length?f.text():"";c[e]=g}return c},this.makeArray=function(a){if(!a||0===a.length)return[];for(var b=[],c=0;c<a.length;c++){var d=$(a[c]).text();b.push(d)}return b},this.getValue=function(a,b){if(!a)return"";if(b)return a.children("VALUE_DECODE").text()||"";var c=a.children("VALUE").text()||"";return"OTHER"===c.toUpperCase()?a.children("VALUE").attr("Other_Value")||"":c},this.getReferences=function(a,b){if(!a||!b)return"";var c=a.attr(b);return c},this.getCurrentSubmission=function(){for(var a=0,b=0;b<c.ViewModel.DOSSIER.SUBMISSIONS.length;b++)parseInt(c.ViewModel.DOSSIER.SUBMISSIONS[b].SUBMISSION_NUMBER)>a&&(a=parseInt(c.ViewModel.DOSSIER.SUBMISSIONS[b].SUBMISSION_NUMBER));return a},this.getLastChange=function(a){for(var b=0,c="",d=0;d<a.length;d++){var e=a[d];parseInt(e.SUBMISSION_NUMBER)>b&&("NEW"===e.CONTENT_STATUS.toUpperCase()||"REPLACE"===e.CONTENT_STATUS.toUpperCase()||"MODIFIED"===e.CONTENT_STATUS.toUpperCase()||"RETIRED"===e.CONTENT_STATUS.toUpperCase())&&(b=parseInt(e.SUBMISSION_NUMBER),c=e.CONTENT_STATUS)}return b>0&&c.length>0?{Submission:this.padZero(b,2),Status:c}:{Submission:null,Status:""}},this.getCurrentStatus=function(a,b){for(var c=0;c<a.length;c++){if(parseInt(a[c].SUBMISSION_NUMBER)===parseInt(b))return a[c].CONTENT_STATUS;if("Retired"===a[c].CONTENT_STATUS)return a[c].CONTENT_STATUS}return"No Change"},this.combineMetadataStatus=function(a,b){return"No Change"===a?b:"No Change"===b?a:b===a?b:"unkown"},this.copyByValue=function(a,b){if(!a||!b)return{};for(var c={},d=0;d<b.length;d++)c[b[d]]=a[b[d]];return c},this.padZero=function(a,b){// change to string
for(var c=a+"";c.length<b;)c="0"+c;//add leading zero until total size is reached
return c},
// RESOLVER
this.resolveReceiver=function(a){if(!a||!c.ViewModel.RECEIVERS)return{};for(var b=0;b<c.ViewModel.RECEIVERS.length;b++)if(c.ViewModel.RECEIVERS[b]._Id===a)return c.ViewModel.RECEIVERS[b];return{}},this.resolveLegalEntity=function(a){if(!a||!c.ViewModel.LEGAL_ENTITIES)return{};for(var b=0;b<c.ViewModel.LEGAL_ENTITIES.length;b++)if(c.ViewModel.LEGAL_ENTITIES[b]._Id===a)return c.ViewModel.LEGAL_ENTITIES[b];return{}},this.resolveSubstance=function(a){if(!a||!c.ViewModel.SUBSTANCES)return{};for(var b=0;b<c.ViewModel.SUBSTANCES.length;b++)if(c.ViewModel.SUBSTANCES[b]._Id===a)return c.ViewModel.SUBSTANCES[b];return{}},this.resolveFile=function(a){if(!a||!c.ViewModel.FILES)return{};for(var b=0;b<c.ViewModel.FILES.length;b++)if(c.ViewModel.FILES[b]._Id===a)return c.ViewModel.FILES[b];return{}},c.resolveDocument=function(a){if(!a||!c.ViewModel.DOCUMENTS)return{};for(var b=0;b<c.ViewModel.DOCUMENTS.length;b++)if(c.ViewModel.DOCUMENTS[b]._Id===a)return c.ViewModel.DOCUMENTS[b];return{}},this.resolveDocumentInList=function(a){if(!a||!c.ViewModel.DOCLIST)return{};for(var b=0;b<c.ViewModel.DOCLIST.length;b++)if(c.ViewModel.DOCLIST[b].Id===a)return c.ViewModel.DOCLIST[b];return{}},this.resolveNode=function(a){return{}},this.resolveFileInfoPerRA=function(a,b){
//var file = this.resolveFile(file);
for(var c=0;c<a.FILE_RA.length;c++)if(a.FILE_RA[c].REF_RA_Id===b)return a.FILE_RA[c];return null},c.xmlData=a.getData(),console.log("Start XML parse: "+Date.now()),c.generateViewModel(),console.log("Finished XML parse: "+Date.now()),
// KEEP
this.getViewModel=function(a,b){if(!a)return{};switch(a){case"filter":return c.ViewModel.FILTER;case"partners":return c.ViewModel.RECEIVERS;case"product":return c.ViewModel.PRODUCT;case"dossier":return c.ViewModel.DOSSIER;case"info":return c.ViewModel.INFO;case"doclist":return c.ViewModel.DOCLIST;case"filelist":return c.ViewModel.FILELIST;case"tree":return{tree:c.ViewModel.TREE};case"document":return c.resolveDocument(b);default:return{}}},this.setViewModel=function(a,b){c.ViewModel[a]=b},this.getTopTreeNode=function(){return c.ViewModel.TREE[0]},
// will return ONE or MORE!!!
this.getDocNodesById=function(a){function b(c){if("DOC"===c.type)c.id===a&&d.push(c);else for(var e=0;e<c.children.length;e++)b(c.children[e])}var d=[];return b(c.ViewModel.TREE[0]),d},
// will return just ONE!
this.getDocNodeByIndex=function(a){function b(c){if("DOC"===c.type)return c.docIndex===a?c:null;for(var d=0;d<c.children.length;d++){var e=b(c.children[d]);if(e)return e}return null}0>a&&(a=c.ViewModel.TREE.docCount-1),a>c.ViewModel.TREE.docCount-1&&(a=0);var d=b(c.ViewModel.TREE[0]);return d?d:null},this.getNodePathOfDoc=function(a){function b(c){if("DOC"===c.type){if(c.docIndex===a)return d.push(c),!0}else for(var e=0;e<c.children.length;e++){var f=b(c.children[e]);if(f)return d.push(c),!0}}var d=[];return b(c.ViewModel.TREE[0]),d},this.getFirstDocumentNodeInTree=function(){function a(c){if("DOC"===c.type&&0===c.docIndex)return c;for(var d=0;d<c.children.length;d++)if(b=a(c.children[d]))return b}var b=null;return b=a(c.ViewModel.TREE[0]),b?b:{}},this.getNextDocumentInTree=function(a){function b(c){if("DOC"===c.type){if(d)return c.id;c.id===a&&(d=!0)}else for(var f=0;!e&&f<c.children.length;f++)if(e=b(c.children[f]))return e}var d=!1,e=null;return e=b(c.ViewModel.TREE[0]),e?this.getDocumentById(e):this.getFirstDocumentNodeInTree()},this.getPrevDocumentInTree=function(a){function b(c){if("DOC"===c.type&&c.id===a)return!0;for(var f=0;f<c.children.length&&!(d=b(c.children[f]));f++)"DOC"===c.children[f].type&&(e=c.children[f].id);return d}var d=!1,e="";b(c.ViewModel.TREE[0])},this.getFirstDocument=function(){return c.ViewModel.DOCUMENTS&&c.ViewModel.DOCUMENTS.length>0?c.ViewModel.DOCUMENTS[0]:null},this.getNextDocumentInList=function(a){return b(!0,a,c.ViewModel.DOCLIST,!1)},this.getPrevDocumentInList=function(a){return b(!0,a,c.ViewModel.DOCLIST,!0)},this.getNextFileInList=function(a){return b(!1,a,c.ViewModel.FILELIST,!1)},this.getPrevFileInList=function(a){return b(!1,a,c.ViewModel.FILELIST,!0)},
// the table list is already filtered by smart-table
this.getNextDocumentInTable=function(a){for(var b=c.ViewModel.TABLELIST,d=0;d<b.length;d++)if(b[d].Id===a)
// resolve next one or first in list
// resolve next one or first in list
return c.resolveDocument(d===b.length-1?b[0].Id:b[d+1].Id);
// return nothing or first if no document has been found
// return nothing or first if no document has been found
return 0===b.length?null:c.resolveDocument(b[0].Id)},this.getPrevDocumentInTable=function(a){for(var b=c.ViewModel.TABLELIST,d=0;d<b.length;d++)if(b[d].Id===a)
// resolve next one or first in list
// resolve next one or first in list
return c.resolveDocument(0===d?b[b.length-1].Id:b[d-1].Id);
// return nothing or first if no document has been found
// return nothing or first if no document has been found
return 0===b.length?null:c.resolveDocument(b[0].Id)},c.getDocumentById=function(a){if(!a||!c.ViewModel.DOCUMENTS)return{};for(var b=0;b<c.ViewModel.DOCUMENTS.length;b++)if(c.ViewModel.DOCUMENTS[b]._Id===a)return c.ViewModel.DOCUMENTS[b];return{}},c.getMainFileOfDocumentById=function(a){if(!a||!c.ViewModel.DOCUMENTS)return null;var b=c.getDocumentById(a),d=null;return b&&(d=c.getFileById(b.MAIN_FILE_ID)),d},this.getFirstFile=function(){return c.ViewModel.FILES[0]},c.getFileById=function(a){if(!a||!c.ViewModel.FILES)return null;for(var b=0;b<c.ViewModel.FILES.length;b++)if(c.ViewModel.FILES[b]._Id===a)return c.ViewModel.FILES[b];return null}}])}(),function(){var a=angular.module("ghsts-controller-menu",["ghsts-model","ghsts-state-service"]);a.controller("MenuController",["$scope","GhstsModelData","GhstsStateService","GhstsViewerFilter",function(a,b,c,d){a.State=c.getState(),a.changeState=function(a){c.setViewerState(a)},a.expandAll=function(){c.setTreeExpanded()},a.collapseAll=function(){c.setTreeCollapsed()},a.showNext=function(){c.setNext(a.State.Viewer.StructureView)},a.showPrev=function(){c.setPrev(a.State.Viewer.StructureView)},a.treedata=b.getViewModel("tree"),a.$watch("treedata.tree",function(b){b&&b.length>0&&!a.fullDocCount&&(a.fullDocCount=b.docCount)}),a.FilterData=d.getFilterData(),a.Filter=d.getFilter(),a.clearFilter=function(){a.Filter.changedSince="all",a.Filter.filterOnRA="ALL",a.Filter.searchText="",a.Filter.hideEmptyNodes=!1},a.isFilterActive=function(){return"ALL"===a.Filter.filterOnRA&&"all"===a.Filter.changedSince&&0===a.Filter.searchText.length&&a.Filter.hideEmptyNodes===!1?!1:!0},a.getFilterIconClass=function(){return"ALL"===a.Filter.filterOnRA&&"all"===a.Filter.changedSince&&0===a.Filter.searchText.length&&a.Filter.hideEmptyNodes===!1?"base-color":"base-inverted-color"}}])}(),function(){var a=angular.module("ghsts-controller-filter",["ghsts-filter-service"]);a.controller("FilterController",["$scope","GhstsViewerFilter",function(a,b){a.FilterData=b.getFilterData(),a.Filter=b.getFilter()}])}(),function(){var a=angular.module("ghsts-filter-service",["ghsts-model"]);a.service("GhstsViewerFilter",["GhstsModelData",function(a){var b=this;
// Public Interface
// Konstruktor
return b.generateFilterData=function(){var b=a.getViewModel("filter");return{RAs:b.RAs,Submissions:b.Submissions}},b.initFilter=function(){return{filterOnRA:"ALL",changedSince:"all",searchText:"",hideEmptyNodes:!1}},b.getFilterData=function(){return b.FilterData},b.setFilter=function(a,c){b.CurrentFilter[a]=c},b.getFilter=function(){return b.CurrentFilter},b.FilterData=b.generateFilterData(),b.CurrentFilter=b.initFilter(),{getFilterData:b.getFilterData,getFilter:b.getFilter,setFilter:b.setFilter}}]),a.filter("documentFilterOnRA",["GhstsViewerFilter",function(a){var b=this;return b.Filter=a.getFilter(),function(a){var c=[];if(a)for(var d=0;d<a.length;d++){var e=a[d];"ALL"===b.Filter.filterOnRA||-1!=e.forRA.indexOf(b.Filter.filterOnRA)?e.filtered=!1:e.filtered=!0,c.push(e)}return c}}]),a.filter("filterOnRA",["GhstsViewerFilter",function(a){var b=this;return b.Filter=a.getFilter(),function(a){var c=[];if(a)for(var d=0;d<a.length;d++)("ALL"===b.Filter.filterOnRA||-1!=a[d].forRA.indexOf(b.Filter.filterOnRA))&&c.push(a[d]);return c}}]),a.filter("setTOCVisibilityFilter",["GhstsViewerFilter",function(b){var c=this;return c.Filter=b.getFilter(),function(b){function d(b){b.isVisible=!0,b.docCount=1,a.setConfidentialFlag(c.Filter.filterOnRA,b)}function e(a){if(""===c.Filter.searchText)return void d(a);
// TODO refactor with setListVisibilityFilter
// build a list of items that should be matched with the filter text
var b=[];b.push(a.currentStatus),b.push(a.parentName),a.DOCUMENT_NUMBER.forEach(function(a){b.push(a.IDENTIFIER)}),b.push(a.DOCUMENT_AUTHOR),b.push(a.name),b.push(a.ISSUE_DATE.split("-")[0]),a.TEST_LABORATORY.forEach(function(a){b.push(a)}),b.push(""===a.COMPLETE_DOCUMENT_SOURCE?a.DOCUMENT_SOURCE+", Year: "+a.DOCUMENT_YEAR+", Issue: "+a.DOCUMENT_ISSUE+", Volume: "+a.DOCUMENT_VOLUME+", Pages: "+a.DOCUMENT_PAGES:a.COMPLETE_DOCUMENT_SOURCE),a.DOCUMENT_OWNER.forEach(function(a){b.push(a)});var e=!1;b.forEach(function(a){-1!=a.indexOf(c.Filter.searchText)&&(e=!0)}),e&&d(a)}function f(a){if(a.docCount=0,a.children&&a.children.length>0)for(var b=0;b<a.children.length;b++)f(a.children[b]),a.docCount+=a.children[b].docCount;"NODE"===a.type&&(c.Filter.hideEmptyNodes===!0?a.isVisible=a.docCount>0?!0:!1:a.isVisible=!0),"DOC"===a.type&&(a.isVisible=!1,a.docCount=0,("ALL"===c.Filter.filterOnRA||-1!=a.forRA.indexOf(c.Filter.filterOnRA))&&("all"===c.Filter.changedSince||parseInt(a.lastChange.Submission)>=parseInt(c.Filter.changedSince))&&e(a))}return f(b[0]),b}}]),a.filter("setListVisibilityFilter",["GhstsViewerFilter",function(b){var c=this;return c.Filter=b.getFilter(),function(b){function d(b){b.isVisible=!0,a.setConfidentialFlag(c.Filter.filterOnRA,b),g.push(b)}
// check for attribute match if filter is set
function e(a){if(""===c.Filter.searchText)return void d(a);
// build a list of items that should be matched with the filter text
var b=[];b.push(a.currentStatus),a.toc_refs.forEach(function(a){b.push(a.name)}),a.DOCUMENT_NUMBER.forEach(function(a){b.push(a.IDENTIFIER)}),b.push(a.DOCUMENT_AUTHOR),b.push(a.name),b.push(a.DOCUMENT_ISSUE_DATE.split("-")[0]),a.TEST_LABORATORY.forEach(function(a){b.push(a)}),b.push(""===a.COMPLETE_DOCUMENT_SOURCE?a.DOCUMENT_SOURCE+", Year: "+a.DOCUMENT_YEAR+", Issue: "+a.DOCUMENT_ISSUE+", Volume: "+a.DOCUMENT_VOLUME+", Pages: "+a.DOCUMENT_PAGES:a.COMPLETE_DOCUMENT_SOURCE),a.DOCUMENT_OWNER.forEach(function(a){b.push(a)});var e=!1;b.forEach(function(a){-1!=a.indexOf(c.Filter.searchText)&&(e=!0)}),e&&d(a)}function f(a){a.isVisible=!1,("ALL"===c.Filter.filterOnRA||-1!=a.forRA.indexOf(c.Filter.filterOnRA))&&("all"===c.Filter.changedSince||parseInt(a.lastChange.Submission)>=parseInt(c.Filter.changedSince))&&e(a)}for(var g=[],h=0;h<b.length;h++)f(b[h]);return g}}]),a.filter("setFilesVisibilityFilter",["GhstsViewerFilter",function(b){var c=this;return c.Filter=b.getFilter(),function(b){function d(b){b.isVisible=!1,("ALL"===c.Filter.filterOnRA||-1!=b.forRA.indexOf(c.Filter.filterOnRA))&&(""===c.Filter.searchText||-1!=b.name.indexOf(c.Filter.searchText))&&(b.isVisible=!0,a.setConfidentialFlag(c.Filter.filterOnRA,b),e.push(b))}for(var e=[],f=0;f<b.length;f++)d(b[f]);return e}}]),a.setConfidentialFlag=function(a,b){if(b.confidential=!1,"ALL"===a){for(var c=0;c<b.confidentialForRA.length;c++)if(b.confidentialForRA.indexOf(a)){b.confidential=!0;break}}else-1!=b.confidentialForRA.indexOf(a)&&(b.confidential=!0)}}();var app=angular.module("ghsts-controller-filter");app.directive("ngModelOnblur",function(){return{priority:1,restrict:"A",require:"ngModel",link:function(a,b,c,d){"radio"!==c.type&&"checkbox"!==c.type&&(b.off("input keydown change"),b.on("blur",function(){a.$apply(function(){d.$setViewValue(b.val())})}))}}}),app.directive("ngModelOnreturn",function(){return{priority:1,restrict:"A",require:"ngModel",link:function(a,b,c,d){"radio"!==c.type&&"checkbox"!==c.type&&(b.off("input keydown change"),b.bind("keydown keypress",function(c){13===c.which&&a.$apply(function(){d.$setViewValue(b.val())})}))}}}),function(){
// get path of this script file to determine path of template file
var a=document.getElementsByTagName("script"),b=(a[a.length-1].src,angular.module("ghsts-document-list",[]));b.directive("ghstsDocList",function(){return{restrict:"E",templateUrl:"partials/structure/document-list.html",//currentScriptPath.replace('document-list.js', 'document-list.html'),
replace:!0}})}(),function(){"use strict";var a=angular.module("ghsts-document-table",["smart-table"]);a.directive("ghstsDocTable",function(){return{restrict:"E",templateUrl:"partials/structure/document-table.html",transclude:!0}}),/*
  * Build listener to get recognized if sorting of table changes
  */
a.directive("stListener",["stConfig","$timeout",function(a,b){return{require:"stTable",scope:{stListener:"="},link:{pre:function(a,b,c,d){var e=d.pipe;d.pipe=function(){e(),a.stListener(d.tableState(),d)}}}}}]),a.controller("smartTableCtrl",["$scope","GhstsModelData","GhstsViewerFilter","GhstsStateService",function(a,b,c,d){
// doclist data model
a.doclist=b.getViewModel("doclist"),
// state service
a.Filter=c.getFilter(),a.state=d.getState(),a.$watch("state.Detail.currentDocument",function(b){a.rowSelected(b)}),
// this get triggered on sorting
a.$watch("doclist",function(c){
// set reference back to menu, as this list is filtered and sorted on the scope
b.setViewModel("TABLELIST",a.doclist)}),a.tableChanged=function(b,c){
// trigger scroll if tablestate changed - sort may have changed
d.triggerScroll("TABLE"+a.state.Detail.currentDocument._Id)},
//change in the real data holder
a.rowSelected=function(b){
// if we click the same again don't deselect the row
b===a.lastClickedRowX?b.isSelected=!0:a.lastClickedRowX&&(a.lastClickedRowX.isSelected=!1),a.lastClickedRowX=a.currentlySelectedItem=b}}]),
// reformat date string - only return year
a.filter("tableDateFilter",function(){return function(a){return a?a.split("-")[0]:a}})}(),function(){
// get path of this script file to determine path of template file
var a=document.getElementsByTagName("script"),b=(a[a.length-1].src,angular.module("ghsts-file-list",[]));b.directive("ghstsFileList",function(){return{restrict:"E",templateUrl:"partials/structure/file-list.html",//currentScriptPath.replace('file-list.js', 'file-list.html'),
replace:!0}})}(),function(){var a=angular.module("ghsts-controller-toc",["ghsts-model","treeControl"]);a.directive("ghstsToc",function(){return{restrict:"E",templateUrl:"partials/structure/toc.html",//currentScriptPath.replace('file-list.js', 'file-list.html'),
replace:!0}}),a.controller("TocController",["$scope","GhstsModelData","GhstsViewerFilter","GhstsStateService",function(a,b,c,d){a.treedata=b.getViewModel("tree"),a.treeopts={nodeChildren:"children",dirSelectable:!1,equality:function(a,b){return a&&b?a.nodeIndex===b.nodeIndex:!1}},a.TreeState=d.getState().Tree,this.update=function(){b.getTreeViewModel(!0)},this.showDocument=function(a,b){var c="document";b&&"NODE"===b?c="node":b&&"TOC"===b?c="toc":(d.setDetailDocumentById(a),d.setViewerState("TOC"))},a.Filter=c.getFilter(),a.showOnlyVisible=function(a){return"DOC"!==a.type&&"NODE"!==a.type?a:a.isVisible===!0?a:void 0},a.getNodeLeadingSpaces=function(a){return new Array(4-a.toString().length)}}])}(),function(){var a=angular.module("ghsts-controller-structure",["ghsts-model","ghsts-state-service","ghsts-filter-service"]);a.controller("StructureController",["$scope","GhstsModelData","GhstsStateService","CONFIG",function(a,b,c,d){function e(a){var b=a.split(".");return b[b.length-1].toLowerCase()}a.State=c.getState(),a.doclist=b.getViewModel("doclist"),a.filelist=b.getViewModel("filelist"),a.showDocumentInToc=function(b,d){c.setTreeSelected(d,b.index),c.setDetailDocumentById(d),"TOC"!==a.State.Viewer.StructureView&&c.setViewerState("TOC")},a.showDocumentAndList=function(b){c.setTreeSelected(b),c.setDetailDocumentById(b),"LIST"!==a.State.Viewer.StructureView&&c.setViewerState("LIST")},a.showDocumentAndTable=function(b){c.setTreeSelected(b),c.setDetailDocumentById(b),("TABLE"!==a.State.Viewer.StructureView||"DOCUMENT"!==a.State.Viewer.DetailView)&&c.setViewerState("TABLE")},a.isDocSelected=function(b){return a.State.Detail.currentDocument&&b.Id===a.State.Detail.currentDocument._Id?!0:!1},a.isFileSelected=function(b){return a.State.Detail.currentFile&&b.Id===a.State.Detail.currentFile._Id?!0:!1},a.getTocDocClass=function(b){return"DOC"!==b.type?"doc-folder":a.getDocClass(b)},a.getDocClass=function(a){return a.retired?"doc-retired":a.confidential?"doc-confidential":"doc-normal"},a.showFile=function(a){
// open file in Desktop Viewer if it isn't viewable in web per default
if(c.setDetailFile(a),c.setViewerState("FILES"),c.getState().Detail.currentFile.FILE_GENERIC){var b=c.getState().Detail.currentFile.FILE_GENERIC.FILENAME,f=e(b);"pdf"!==f&&"html"!==f&&"xml"!==f&&("undefined"!=typeof parent.viewerAPI?parent.viewerAPI.openTab("File",parent.viewerAPI.getSubmissionPath()+b):window.open(d.SUBMISSION_ROOT+b))}},a.shortenString=function(a,b){return"undefined"==typeof b&&(b=25),10>b&&(b=10),a.length>b-5?a.substr(0,b-5)+"(...)":a},a.concatString=function(b,c){for(var d="",e=0;e<b.length;e++)d+=a.shortenString(b[e],c)+"<br/>";return d},a.concatFullString=function(a){for(var b="",c=0;c<a.length;c++)b+=a[c]+"<br/>";return b}}])}(),function(){var a=angular.module("ghsts-detail-controllers",["ghsts-model","ghsts-state-service","ghsts-constants"]);a.controller("DetailController",["$scope","GhstsStateService","GhstsViewerFilter","CONFIG",function(a,b,c,d){a.config=d,a.State=b.getState(),a.mainFile={active:!0},a.$watch("State.Detail.currentDocument",function(b){
// find the last active tab
var d;a.raList&&a.raList.forEach(function(a){a.active&&(d=a.id)}),d?a.mainFile.active=!1:a.mainFile.active=!0;
// load all available RAs in the whole submission
// and match them with the RAs available in this document
// we want to only show the detail versions of the 'available' ones
var e=c.getFilterData().RAs,f=a.State.Detail.currentDocument.DOCUMENT_RA;a.raList=[],e.forEach(function(b){var c=!1;f.forEach(function(d){d.RA._Id===b.Id&&(d.id=b.Id,d.available=!0,d.active=!1,a.raList.push(d),c=!0)}),c||a.raList.push({id:b.Id,RA:{SHORT_NAME:b.Name},forRA:b.Name,available:!1,active:!1}),
// check if the last added ra tab has been active
d&&b.Id===d&&(a.raList[a.raList.length-1].active=!0)})}),a.setMainFileActive=function(){console.log("setMainFileActive"),a.State.Detail.openFiles&&a.State.Detail.openFiles.forEach(function(a){a.active=!1}),a.raList&&a.raList.forEach(function(a){a.active=!1}),a.mainFile.active=!0}}]),a.controller("DocumentController",["$scope","GhstsStateService","CONFIG",function(a,b,c){function d(a){var b=a.split(".");return b[b.length-1].toLowerCase()}a.Detail=b.getState().Detail,a.showFile=function(a){b.setDetailFile(a),b.setViewerState("FILES")},a.selectTreeNode=function(a,c){b.setTreeSelected(a,c),"TOC"!==b.getState().Viewer.StructureView&&b.setViewerState("TOC")},a.openFile=function(e,f,g){
// don't open the main file twice - set it only active
if(a.Detail.currentDocument.DOCUMENT_GENERIC.MAIN_FILE_PATH===g)a.$parent.setMainFileActive();else{
// only open web-viewable files
var h=d(g);if("pdf"===h||"html"===h||"xml"===h){console.log(g);var i={id:e,title:f,active:!0,path:g,src:c.SUBMISSION_ROOT+g};console.log(i.src),
// prepare for pdf.js viewing
"pdf"===h&&(i.src=c.PDFJS_FILE_PATH+encodeURIComponent("../"+c.SUBMISSION_ROOT+g)),b.openFileFromDocument(i)}else if("undefined"!=typeof parent.viewerAPI){var j=parent.viewerAPI.getSubmissionPath()+g;parent.viewerAPI.openTab("File",j)}else window.open(c.SUBMISSION_ROOT+g)}}}]),a.controller("MainFileController",["$scope","GhstsStateService","CONFIG",function(a,b,c){a.State=b.getState(),a.Detail=b.getState().Detail,a.$watch("State.Detail.currentDocument",function(b){a.pdfSource=c.PDFJS_FILE_PATH+encodeURIComponent("../"+c.SUBMISSION_ROOT+a.Detail.currentDocument.DOCUMENT_GENERIC.MAIN_FILE_PATH)})}]),a.controller("DossierController",["$scope","GhstsModelData",function(a,b){a.vm=b.getViewModel("dossier"),a.openSubmission=function(a){if("undefined"!=typeof parent.viewerAPI){var c=b.getSubmissionPath(window.location),d=c+"../../../"+a+"/";parent.viewerAPI.openSubmission(d)}}}]),a.controller("ProductController",["$scope","GhstsModelData",function(a,b){a.vm=b.getViewModel("product")}]),a.controller("PartnersController",["$scope","GhstsModelData",function(a,b){a.PartnersViewModel=b.getViewModel("partners"),a.showPartnerDetails=function(b){for(var c=0;c<a.PartnersViewModel.length;c++){if(a.PartnersViewModel[c].REF_LE_Id==b){a.legalEntity=a.PartnersViewModel[c].LEGAL_ENTITY;break}for(var d=0;d<a.PartnersViewModel[c].SENDER.length;d++)if(a.PartnersViewModel[c].SENDER[d].REF_LE_Id==b){a.legalEntity=a.PartnersViewModel[c].SENDER[d].LEGAL_ENTITY;break}}}}]),a.controller("InfoController",["$scope","GhstsModelData","CONFIG",function(a,b,c){a.config=c,a.model=b.getViewModel("info"),a.openPathFolder=function(){},a.shortenPath=function(a,b){return"undefined"==typeof b&&(b=50),10>b&&(b=10),a.length>b-5?"(...)"+a.substr(a.length-(b-5),a.length):a}}]),a.controller("FileController",["$scope","GhstsStateService","CONFIG",function(a,b,c){function d(a){var b=a.split(".");return b[b.length-1].toLowerCase()}a.config=c,a.Detail=b.getState().Detail,a.State=b.getState(),a.$watch("State.Detail.currentFile",function(b){b&&(
// prepare for pdf.js viewing
"pdf"===d(a.Detail.currentFile.FILE_GENERIC.FILENAME)?a.fileSource=c.PDFJS_FILE_PATH+encodeURIComponent("../"+c.SUBMISSION_ROOT+a.Detail.currentFile.FILE_GENERIC.FILENAME):a.fileSource=c.SUBMISSION_ROOT+a.Detail.currentFile.FILE_GENERIC.FILENAME)})}]),
// new attribute to enforce the refreshing of the PDF file displayed
a.directive("embedSrc",function(){return{restrict:"A",link:function(a,b,c){var d=b;a.$watch(function(){return c.embedSrc},function(){var a=b.clone().attr("src",c.embedSrc);d.replaceWith(a),d=a})}}}),a.directive("mimeIcon",function(){return{restrict:"E",template:'<i title="Filetype: {{mimeType}}" alt="{{mimeType}}" class="fa {{fileIcon}} fa-fw"></i>',replace:!0,scope:{mimeType:"@"},controller:["$scope",function(a){a.$watch("mimeType",function(b){if(b)switch(b.toString().toUpperCase()){case"PDF":a.fileIcon="fa-file-pdf-o";break;case"DOC":case"DOCX":a.fileIcon="fa-file-word-o";break;case"TXT":a.fileIcon="fa-file-text-o";break;case"JPG":case"JPEG":case"PNG":case"GIF":a.fileIcon="fa-file-image-o";break;case"ZIP":case"TAR":case"GZ":a.fileIcon="fa-file-zip-o";break;default:a.fileIcon="fa-file-o"}else a.iconClass="fa-file-o"})}]}})}(),function(){var a=angular.module("ghsts-state-service",["ghsts-model"]);a.service("GhstsStateService",["GhstsModelData","$location","$anchorScroll","$timeout","hotkeys",function(a,b,c,d,e){var f=this;
// Public Interface
/* Define hotkeys for state navigation */
// Viewer States
// Tree States
// Detail States
// General Methods
// Konstruktor Code
return e.add({combo:"ctrl+up",description:"Previous Document",callback:function(){console.log("ctrl+up pressed"),f.setPrev(f.State.Viewer.StructureView)}}),e.add({combo:"ctrl+down",description:"Next Document",callback:function(){console.log("ctrl+down pressed"),f.setNext(f.State.Viewer.StructureView)}}),e.add({combo:"ctrl+left",description:"Collapse nodes",callback:function(){"TOC"===f.State.Viewer.StructureView&&f.setTreeCollapsed()}}),e.add({combo:"ctrl+right",description:"Expand nodes",callback:function(){"TOC"===f.State.Viewer.StructureView&&f.setTreeExpanded()}}),f.triggerScroll=function(a){f.gotoAnchor("",""),d(function(){f.gotoAnchor(a,"")},0)},f.gotoAnchor=function(a,d){var e=a+d;b.hash()!==e?
// set the $location.hash to `newHash` and
// $anchorScroll will automatically scroll to it
b.hash(a+d):
// call $anchorScroll() explicitly,
// since $location.hash hasn't changed
c()},f.defineViewerStates=function(){return{TOC:{StructureView:"TOC",DetailView:"DOCUMENT",NavigateView:!0,ToggleView:!0},NODE:{StructureView:"TOC",DetailView:"NODE",NavigateView:!0,ToggleView:!0},LIST:{StructureView:"LIST",DetailView:"DOCUMENT",NavigateView:!0,ToggleView:!1},TABLE:{StructureView:"TABLE",DetailView:"DOCUMENT",NavigateView:!0,ToggleView:!1},FILES:{StructureView:"FILES",DetailView:"FILE",NavigateView:!0,ToggleView:!1},DOSSIER:{StructureView:null,DetailView:"DOSSIER",NavigateView:null,ToggleView:null},PRODUCT:{StructureView:null,DetailView:"PRODUCT",NavigateView:null,ToggleView:null},PARTNERS:{StructureView:null,DetailView:"PARTNERS",NavigateView:!0,ToggleView:null},INFO:{StructureView:null,DetailView:"INFO",NavigateView:null,ToggleView:null}}},f.resolveViewerState=function(a){return a in f.ViewerStates?f.ViewerStates[a]:{StructureView:null,DetailView:null,NavigateView:null,ToggleView:null}},f.setViewerState=function(a){var b=f.resolveViewerState(a);null!==b.StructureView&&b.StructureView!==f.State.Viewer.StructureView&&(f.State.Viewer.StructureView=b.StructureView,f.gotoAnchor(b.StructureView,f.State.Detail.currentDocument._Id)),f.State.Viewer.DetailView=null===b.DetailView?f.State.Viewer.DetailView:b.DetailView,f.State.Viewer.NavigateView=null===b.NavigateView?f.State.Viewer.NavigateView:b.NavigateView,f.State.Viewer.ToggleView=null===b.ToggleView?f.State.Viewer.ToggleView:b.ToggleView},f.setTreeExpanded=function(){function b(a){if(a.children){f.State.Tree.expandedNodes.push(a);for(var c=0;c<a.children.length;c++)b(a.children[c])}}f.State.Tree.expandedNodes=[],b(a.getTopTreeNode())},f.setTreeCollapsed=function(){f.State.Tree.expandedNodes=a.getNodePathOfDoc(f.State.Tree.selectedNode.docIndex)},f.setMoreExpanded=function(b){
// to implement
var c=a.getNodePathOfDoc(f.State.Tree.selectedNode.docIndex);f.State.Tree.expandedNodes=c},f.setTreeSelected=function(b,c){if(c>=0){var d=a.getDocNodeByIndex(c);f.State.Tree.selectedNode=d}else{var e=a.getDocNodesById(b);
// take the first Document only
f.State.Tree.selectedNode=e[0]}f.State.Tree.expandedNodes=a.getNodePathOfDoc(f.State.Tree.selectedNode.docIndex)},f.setDetailDocumentById=function(b){f.State.Detail.currentDocument=a.getDocumentById(b),f.clearOpenDocumentFiles()},f.setDetailDocument=function(a){f.State.Detail.currentDocument=a,f.clearOpenDocumentFiles()},f.clearOpenDocumentFiles=function(){f.State.Detail.openFiles=[]},f.openFileFromDocument=function(a){f.State.Detail.openFiles||f.clearOpenDocumentFiles();for(var b=!1,c=0,d=0;d<f.State.Detail.openFiles.length;d++){var e=f.State.Detail.openFiles[d];if(e.path===a.path){b=!0,
// set this one active
e.active=!0;break}
// find correct insert position
a.id>=e.id&&(c=d+1)}b||(c===a.length?f.State.Detail.openFiles.push(a):f.State.Detail.openFiles.splice(c,0,a))},f.setDetailFile=function(b){f.State.Detail.currentFile=a.getFileById(b)},f.setNext=function(b){switch(b){case"TOC":var c=f.State.Tree.selectedNode.docIndex;do{var d=f.State.Tree.selectedNode.docIndex+1;f.State.Tree.selectedNode=a.getDocNodeByIndex(d)}while(f.State.Tree.selectedNode.isVisible===!1&&f.State.Tree.selectedNode.docIndex!==c);f.State.Tree.expandedNodes=a.getNodePathOfDoc(f.State.Tree.selectedNode.docIndex),f.setDetailDocument(a.getDocumentById(f.State.Tree.selectedNode.id));break;case"FILES":f.State.Detail.currentFile?f.State.Detail.currentFile=a.getNextFileInList(f.State.Detail.currentFile._Id):f.State.Detail.currentFile=a.getFirstFile();break;case"TABLE":f.setDetailDocument(f.State.Detail.currentDocument?a.getNextDocumentInTable(f.State.Detail.currentDocument._Id):a.getFirstDocument()),f.setTreeSelected(f.State.Detail.currentDocument._Id);break;default:f.setDetailDocument(f.State.Detail.currentDocument?a.getNextDocumentInList(f.State.Detail.currentDocument._Id):a.getFirstDocument())}f.setViewerState(b),f.gotoAnchor(f.State.Viewer.StructureView,f.State.Detail.currentDocument._Id)},f.setPrev=function(b){switch(b){case"TOC":var c=f.State.Tree.selectedNode.docIndex;do{var d=f.State.Tree.selectedNode.docIndex-1;f.State.Tree.selectedNode=a.getDocNodeByIndex(d)}while(f.State.Tree.selectedNode.isVisible===!1&&f.State.Tree.selectedNode.docIndex!==c);f.State.Tree.expandedNodes=a.getNodePathOfDoc(f.State.Tree.selectedNode.docIndex),f.setDetailDocument(a.getDocumentById(f.State.Tree.selectedNode.id));break;case"FILES":f.State.Detail.currentFile?f.State.Detail.currentFile=a.getPrevFileInList(f.State.Detail.currentFile._Id):f.State.Detail.currentFile=a.getFirstFile();break;case"TABLE":f.setDetailDocument(f.State.Detail.currentDocument?a.getPrevDocumentInTable(f.State.Detail.currentDocument._Id):a.getFirstDocument()),f.setTreeSelected(f.State.Detail.currentDocument._Id);break;default:f.setDetailDocument(f.State.Detail.currentDocument?a.getPrevDocumentInList(f.State.Detail.currentDocument._Id):a.getFirstDocument())}f.setViewerState(b),f.gotoAnchor(f.State.Viewer.StructureView,f.State.Detail.currentDocument._Id)},f.initState=function(){var b=a.getDocNodeByIndex(0),c=f.resolveViewerState("TOC");return{Viewer:{StructureView:c.StructureView,DetailView:c.DetailView,ToggleView:c.ToggleView,NavigateView:c.NavigateView},Tree:{expandedNodes:b?a.getNodePathOfDoc(b.docIndex):[],selectedNode:b?b:{}},Detail:{currentDocument:b?a.getDocumentById(b.id):null,currentFile:b?a.getMainFileOfDocumentById(b.id):null}}},f.getState=function(){return f.State},f.ViewerStates=f.defineViewerStates(),f.State=f.initState(),{getState:f.getState,setViewerState:f.setViewerState,setTreeExpanded:f.setTreeExpanded,setTreeCollapsed:f.setTreeCollapsed,setTreeSelected:f.setTreeSelected,setDetailDocumentById:f.setDetailDocumentById,openFileFromDocument:f.openFileFromDocument,setDetailFile:f.setDetailFile,setNext:f.setNext,setPrev:f.setPrev,triggerScroll:f.triggerScroll}}])}();var app=angular.module("GhstsViewer");app.directive("statusIconStatic",function(){return{restrict:"E",template:'<i bindonce="icon" bo-class="\'fa \' + icon.class + \' fa-fw\'" bo-style="{\'color\': icon.color}" bo-title="icon.status" bo-alt="icon.status"></i>',replace:!0,scope:{statusValue:"@"},controller:["$scope",function(a){switch(a.icon={},a.icon.status=a.statusValue,a.statusValue){case"No Change":a.icon["class"]="fa-bars",a.icon.color="dodgerblue";break;case"New":a.icon["class"]="fa-share",a.icon.color="limegreen";break;case"Modified":a.icon["class"]="fa-pencil",a.icon.color="darkorange";break;case"Replace":a.icon["class"]="fa-refresh",a.icon.color="firebrick";break;case"Retired":a.icon["class"]="fa-trash",a.icon.color="gray";break;default:a.icon["class"]="fa-question",a.icon.color="gray"}}]}}),app.directive("statusIcon",function(){return{restrict:"E",template:'<i class="fa {{iconClass}} fa-fw" style="color: {{iconColor}}" title="{{statusValue}}" alt="{{statusValue}}"></i>',replace:!0,scope:{statusValue:"@"},controller:["$scope",function(a){a.$watch("statusValue",function(b){if(b)switch(a.statusValue){case"No Change":a.iconClass="fa-bars",a.iconColor="dodgerblue";break;case"New":a.iconClass="fa-share",a.iconColor="limegreen";break;case"Modified":a.iconClass="fa-pencil",a.iconColor="darkorange";break;case"Replace":a.iconClass="fa-refresh",a.iconColor="firebrick";break;case"Retired":a.iconClass="fa-trash",a.iconColor="gray";break;default:a.iconClass="fa-question",a.iconColor="gray"}else a.iconClass="fa-question",a.iconColor="gray"})}]}}),app.directive("metadataIcon",function(){return{restrict:"E",template:'<i class="fa fa-tag fa-fw" style="color: gray;" title="METADATA Status" alt="METADATA Status"></i>',replace:!0}}),app.directive("contentIcon",function(){return{restrict:"E",template:'<i class="fa fa-files-o fa-fw" title="CONTENT Status" alt="CONTENT Status"></i>',replace:!0}}),app.directive("openFolderIcon",function(){return{restrict:"E",template:'<a href="" ng-click="openPathFolder()" title="Show on file system"><i class="fa fa-fw fa-folder-open-o"></i></a>',replace:!0,scope:{path:"@",relative:"@"},controller:["$scope","GhstsModelData",function(a,b){a.openPathFolder=function(){"undefined"!=typeof parent.viewerAPI&&
// utils/viewer/viewerIndex.html is two levels deeper than the relative links
parent.viewerAPI.openFolder(a.relative?b.getSubmissionPath(window.location.href)+"../../"+a.path:a.path)}}]}}),app.directive("boolIconStatic",function(){return{restrict:"E",template:'<i bindonce="icon" bo-class="\'fa \' + icon.class +\' fa-f\'" bo-style="{\'color\': icon.color}" bo-title="icon.bool" bo-alt="icon.bool"></i>',replace:!0,scope:{boolValue:"@"},controller:["$scope",function(a){switch(a.icon={},a.icon.bool=a.boolValue,a.boolValue.toString().toUpperCase()){case"TRUE":case"YES":a.icon["class"]="fa-check",a.icon.color="green";break;case"FALSE":case"NO":a.icon["class"]="fa-minus",a.icon.color="red";break;default:a.icon["class"]="fa-question",a.icon.color="gray"}}]}}),app.directive("boolIcon",function(){return{restrict:"E",template:'<i class="fa {{iconClass}} fa-fw" style="color: {{iconColor}}" title="{{boolValue}}" alt="{{boolValue}}"></i>',replace:!0,scope:{boolValue:"@"},controller:["$scope",function(a){a.$watch("boolValue",function(b){if(b)switch(b.toString().toUpperCase()){case"TRUE":case"YES":a.iconClass="fa-check",a.iconColor="green";break;case"FALSE":case"NO":a.iconClass="fa-minus",a.iconColor="red";break;default:a.iconClass="fa-question",a.iconColor="gray"}else a.iconClass="fa-question",a.iconColor="gray"})}]}});