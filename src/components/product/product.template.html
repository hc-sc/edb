<md-content layout-padding class="autoScroll" class='stretch-row'>
  <form>
    <div>
      <md-input-container class="md-block" flex>
        <label>Generic Product Name</label>
        <input ng-model="_ctrl.selected.GENERIC_PRODUCT_NAME" type="text" ng-required="true">
      </md-input-container>
    </div>

    <div layout-gt-sm="row">
      <md-input-container class="md-block" flex>
        <label>PID</label>
        <input ng-model="_ctrl.selected.PRODUCT_PID" type="text" ng-required="true" disabled>
      </md-input-container>
      <md-input-container class="md-block" flex>
        <label>Status</label>
        <md-select name="productStatus" id="productStatus" ng-model="_ctrl.selected.METADATA_STATUS.VALUE_DECODE" ng-change="_ctrl.updateMetadataValue()">
          <md-option ng-repeat="status in $ctrl.metadataStatusOptions" ng-value="status.VALUE">
            {{ status.VALUE_DECODE }}
          </md-option>
        </md-select>
      </md-input-container>
    </div>

    <div layout="column">
      <div layout='row' flex>
        <md-input-container md-no-float class='md-block'>
          <label for="formulationType">Formulation Type</label>
          <md-select name="formulationType" id="formulationType" ng-model="_ctrl.selected.FORMULATION_TYPE.VALUE" ng-change="_ctrl.updateFormulation()">
            <md-option ng-repeat="formulationType in $ctrl.formulations" ng-value="formulationType.VALUE">
              {{ formulationType.VALUE }}
            </md-option>
          </md-select>
        </md-input-container>
        <icon-button style='display: inline-block' icon='add' colour='dark' label='Add New Formulation'></icon-button>
      </div>
      <div style="padding-top:5px;" layout-gt-sm="row" ng-show="_ctrl.selected.FORMULATION_TYPE.VALUE === _ctrl.getOtherValue()">
        <md-input-container class="md-block" flex>
          <label for="formulationValueDecode">Display Value</label>
          <input ng-model="_ctrl.selected.FORMULATION_TYPE.VALUE_DECODE" id="formulationValueDecode" type="text">
        </md-input-container>
        <md-input-container class="md-block" flex>
          <label for="formulationValue">Encoded Value (optional)</label>
          <input ng-model="_ctrl.selected.FORMULATION_TYPE.ATTR_VALUE" id="formulationValue" type="text">
        </md-input-container>
      </div>
    </div>

    <md-toolbar>
      <div class="md-toolbar-tools">
        <h2>Ingredients</h2>
        <span flex></span>
        <md-button class="md-icon-button" ng-click="_ctrl.addIngredient()">
          <md-icon class='light' md-svg-icon="add" aria-label="Add Identifier"></md-icon>
        </md-button>
      </div>
    </md-toolbar>

    <md-list>
      <md-card ng-repeat="ing in _ctrl.selected.INGREDIENTS track by $index" class="list-item-card">
        <div layout-gt-sm="row">
          <md-input-container class="md-block" flex>
            <label for="substances">Substance</label>
            <md-select name="substances" ng-model="ing._toSubstanceID">
              <md-option ng-repeat="substance in _ctrl.substances" value="{{ substance._identifier }}" ng-selected="{{ substance._identifier === ing._toSubstanceID }}">
                {{ substance.SUBSTANCE_NAME }}
              </md-option>
            </md-select>
          </md-input-container>
        </div>
        <div layout-gt-sm="row">
          <md-input-container class="md-block" flex>
            <label>Amount</label>
            <input ng-model="ing.QUANTITY" type="text">
          </md-input-container>
          <md-input-container class="md-block" flex>
            <label>Unit</label>
            <md-select name="unit" ng-model="ing.UNIT.VALUE" ng-change="_ctrl.updateUnit(ing)">
              <md-option ng-repeat="u in _ctrl.units" value="{{ u.VALUE }}" ng-selected="{{ u.VALUE === ing.UNIT.VALUE }}">
                {{ u.VALUE }}
              </md-option>
            </md-select>
          </md-input-container>
          <div layout-gt-sm="row" flex-gt-sm="50" ng-show="ing.UNIT.VALUE === _ctrl.getOtherValue()">
            <md-input-container class="md-block" flex>
              <label for="unitValueDecode">Display Value</label>
              <input id="unitValueDecode" type="text" ng-model="ing.UNIT.VALUE_DECODE">
            </md-input-container>
            <md-input-container class="md-block" flex>
              <label for="unitValue">Encoded Value (optional)</label>
              <input id="unitValue" type="text" ng-model="ing.UNIT.ATTR_VALUE">
            </md-input-container>
          </div>
        </div>
        <md-button class="md-secondary md-raised" layout-align="center" ng-click="_ctrl.deleteIngredient(ing._toSubstanceID, $event)">
          Delete
        </md-button>
      </md-card>
    </md-list>

    <md-toolbar>
      <div class="md-toolbar-tools">
        <h2>Regulatory Authority Specifics</h2>
        <span flex></span>
        <md-button class="md-icon-button" ng-click="_ctrl.addProductRA($event)">
          <md-icon class='light' md-svg-icon="add" aria-label="Add Regulatory Authority"></md-icon>
        </md-button>
      </div>
    </md-toolbar>

    <md-list>
      <md-list-item ng-repeat="ra in _ctrl.selected.PRODUCT_RA track by $index" ng-click="_ctrl.showProductRADiag(ra, $event)" class="noright">
        <md-icon class="black" md-svg-icon="business-black" aria-label="Regulatory Authority"></md-icon>
        <p>{{ ra.PRODUCT_NAME }}</p>
        <md-button class="md-secondary md-raised" ng-click="_ctrl.deleteProductRA(ra, $event)" aria-label="Delete Regulatory Authority">
          Delete
        </md-button>
      </md-list-item>
    </md-list>
  </form>
</md-content>