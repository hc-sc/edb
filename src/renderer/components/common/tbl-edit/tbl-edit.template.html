<div class='table-container'>
  <md-card class='no-padding'>
    <md-toolbar class='md-table-toolbar' ng-show='!$ctrl.search'>
      <div class='md-toolbar-tools custom-toolbar'>
        <h2 class='md-title'>{{ $ctrl.title }}</h2>
        <div flex></div>
        <icon icon='$ctrl.searchIcon' ng-click='$ctrl.toggleSearch()'></icon>
        <icon icon='$ctrl.addIcon' ng-click='$ctrl.onAdd()'></icon>
      </div>
    </md-toolbar>
    <md-toolbar class='md-table-toolbar custom-toolbar md-default' ng-show='$ctrl.search'>
      <div class='md-toolbar-tools custom-toolbar'>
        <text-input class='search-input' label='Search' text-value='$ctrl.searchText' message='invalid' on-update='$ctrl.update("searchText", value)'></text-input>
        <icon icon='$ctrl.closeIcon' ng-click='$ctrl.toggleSearch()'></icon>
      </div>
    </md-toolbar>
    <md-table-container>
      <table md-table>
        <thead md-head>
          <tr md-row>
            <th md-column ng-if='$ctrl.deletable' class='icon-cell'></th>
            <th md-column ng-if='$ctrl.editable' class='icon-cell'></th>
            <th md-column ng-if='$ctrl.viewable' class='icon-cell'></th>
            <th ng-repeat='header in $ctrl.headers' md-column ng-click='$ctrl.setSort(header)'>
              {{header.name | translate}}
              <md-icon class='table-sort-icon' ng-class='{
                "sort-ascending": ($ctrl.sortField === header.paramName && $ctrl.reverse),
                "sort-descending": ($ctrl.sortField === header.paramName && !$ctrl.reverse)
              }' md-svg-icon='up'></md-icon>
            </th>
          </tr>
        </thead>
        <tbody md-body>
          <tr ng-repeat='row in $ctrl.rows | index | filter:$ctrl.searchText | orderBy:$ctrl.sortField:$ctrl.reverse' md-row ng-class='{selected: row.isSelected}'>
            <td ng-show='$ctrl.deletable' class='icon-cell'>
              <icon icon='$ctrl.deleteIcon' ng-click='$ctrl.delete(row.index)' disabled='!row.deletable || false' color='row.isSelected ? dark : light'></icon>
            </td>
            <td ng-show='$ctrl.editable' class='icon-cell'>
              <icon icon='$ctrl.editIcon' ng-click='$ctrl.edit(row.index)' disabled='!row.editable || false' color='row.isSelected ? dark : dark'></icon>
            </td>
            <td ng-show='$ctrl.viewable' class='icon-cell'>
              <icon icon='$ctrl.viewIcon' ng-click='$ctrl.view(row.index)' disabled='!row.viewable || false' color='row.isSelected ? dark : light'></icon>
            </td>
            <td ng-repeat='data in row track by $index' ng-if='!$last' ng-click='$ctrl.select(row[row.length - 1], row.index)'>{{$ctrl.getData(data, $index)}}</td>
          </tr>
        </tbody>
      </table>
    </md-table-container>
  </md-card>
  <p class='error-message' ng-if='!$ctrl.rows || $ctrl.rows.length < $ctrl.minItems'>Must have at least {{ $ctrl.minItems }} {{ $ctrl.title  }} record</p>
</div>