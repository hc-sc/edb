<section class='node-page'>
  <spinner ng-if='$ctrl.loading'></spinner>
  <div class='no-margin no-padding' ng-if='!$ctrl.loading'>
    <div ng-if='$ctrl.records && $ctrl.records.length == 0'>{{"noitems" | translate}}</div>
    <div ng-if='!($ctrl.records && $ctrl.records.length == 0)'>
      <sidenav items='$ctrl.records' selected='$ctrl.selected' main='genericproductname' is-open='$ctrl.sidenavOpen' on-select='$ctrl.updateSelected(item)'
        on-add='$ctrl.add(item)'></sidenav>
      <div class='extension-wrapper'>
        <text-input label='{{"productid" | translate}}' is-required='true' text-value='$ctrl.selected.productpid' on-update='$ctrl.update("productpid", value)'></text-input>
        <md-button class='md-raised md-primary' ng-click='$ctrl.genPid()'>Generate PID</md-button>
      </div>
      <text-input label='{{"genericproductname" | translate}}' is-required='true' text-value='$ctrl.selected.genericproductname' on-update='$ctrl.update("genericproductname", value)' max-Length='255' has-pattern='^[^#]*$' message='Cannot contain the # character'></text-input>
      <select-input-extensible label='{{"formulationtype" | translate}}' is-required='true' select-value='$ctrl.selected.formulationtype' on-update='$ctrl.update("formulationtype", value)'
        values='$ctrl.formulationType' type-name='EXTENSION_TYPE_FORMULATION_TYPE' on-add='$ctrl.createPicklistItem("formulationtype", "formulationType", value)'>
      </select-input-extensible>

      <tbl-new ng-if='!$ctrl.loading' title='{{"ingredients" | translate}}' items='$ctrl.selected.ingredients.ingredient' projection='[{name: "toSubstanceId", url: "substance"}, "quantity", {name: "unit", url: "picklist"}]' deletable='true'
        on-select='$ctrl.selectTblItem("ingredients.ingredient",index)' on-add='$ctrl.addTblItem("ingredients.ingredient")' on-delete='$ctrl.deleteTblItem("ingredients.ingredient",index)' min-items='1' is-required='true'>
      </tbl-new>
      <tbl-new ng-if='!$ctrl.loading  && $ctrl.isSubmission' title='{{"productregulartoryauthorities" | translate}}' items='$ctrl.selected.productra' projection='[{name: "toSpecificForRAId", url: "receiver"}, "productname"]' deletable='true
      ' on-select='$ctrl.selectTblItem("productra",index)' on-add='$ctrl.addTblItem("productra")' on-delete='$ctrl.deleteTblItem("productra",index)'></tbl-new>
    </div>

    <div class='float-bottom'>
      <md-button aria-label='Save' class='md-fab md-primary' ng-click='$ctrl.save()'>
        <md-tooltip>Save</md-tooltip>
        <md-icon md-svg-icon='save' class='light'></md-icon>
      </md-button>
      <md-button ng-if='!$ctrl.isSubmission' aria-label='Add New Item' class='md-fab md-primary' ng-click='$ctrl.add("product")'>
        <md-tooltip>Add</md-tooltip>
        <md-icon md-svg-icon='add' class='light'></md-icon>
      </md-button>
      <md-button ng-if='!$ctrl.isSubmission' aria-label='Toggle List' class='md-fab md-primary' ng-click='$ctrl.toggleList()'>
        <md-tooltip>View List</md-tooltip>
        <md-icon md-svg-icon='list' class='light'></md-icon>
      </md-button>
    </div>
  </div>
</section>