<section layout-fill layout='row'>
    <md-sidenav class="md-sidenav-left md-whiteframe-z2" md-component-id="left" md-is-locked-open="$mdMedia('gt-sm')">
        <md-toolbar class="md-whiteframe-z1" layout="row">
            <div class="md-toolbar-tools">
                <md-button class="md-icon-button" aria-label="Back" ng-href="#/manage" ng-click="_ctrl.confirmLeavePage($event)">
                    <md-icon md-svg-icon="back" aria-label="back"></md-icon>
                </md-button>
                <h2>
                    <span>Substances</span>
                </h2>
            </div>
        </md-toolbar>
        <md-input-container style="margin-bottom:0">
            <label>Substance</label>
            <input name="substanceName" ng-model="_ctrl.filterText" ng-change="_ctrl.filterSubstance()">
        </md-input-container>
        <md-content>
            <md-list>
                <md-list-item ng-repeat="it in _ctrl.substances track by $index" ng-click="_ctrl.selectSubstance(it, $index)">
                    <md-icon class="black" md-svg-icon="album-black" aria-label="description"></md-icon>
                    <p>{{it.SUBSTANCE_NAME}}</p>
                    <md-divider ng-if="!$last"></md-divider>
                </md-list-item>
            </md-list>
        </md-content>
    </md-sidenav>

    <div layout-fill layout='column' tabIndex='-1' role='main' class='md-whiteframe-z2'>
        <md-toolbar layout="row" class="md-whiteframe-z1">
            <div class="md-toolbar-tools">
                <md-button class="md-icon-button" aria-label="substances" ng-click="_ctrl.toggleSidenav('left')" hide-gt-sm>
                    <md-icon class="white" md-svg-icon="album-black" aria-label="substance"></md-icon>
                </md-button>
                <h2> {{ _ctrl.selected.SUBSTANCE_NAME }}</h2>
            </div>
        </md-toolbar>
        <md-content layout-padding>
            <form name='substanceForm' id='substanceForm'>
                <div layout-gt-xs='row'>
                    <md-input-container class='md-block' flex-gt-sm>
                        <label for='identifier'>Identifier</label>
                        <input ng-model='_ctrl.selected._identifier' name='identifier' type='text' disabled />
                    </md-input-container>
                    <md-input-container class='md-block' flex-gt-sm>
                        <label for='pid'>PID</label>
                        <input ng-model='_ctrl.selected.SUBSTANCE_PID' name='pid' type='text' disabled />
                    </md-input-container>
                </div>
                <div layout-gt-sm='row'>
                    <md-input-container class='md-block' flex-gt-sm>
                        <label for='name'>Name</label>
                        <input required ng-model='_ctrl.selected.SUBSTANCE_NAME' name='name' type='text' />
                    </md-input-container>
                    <md-input-container class="md-block" flex="20">
                        <label for='repeatSelectStatus'>Status</label>
                        <md-select name='repeatSelectStatus' id="repeatSelectStatus" ng-model='_ctrl.selected.METADATA_STATUS.VALUE' ng-change="_ctrl.updateSelectedStatusDecode()">
                            <md-option ng-repeat="substanceStatus in _ctrl.metadataStatusOptions" ng-value="substanceStatus.VALUE">{{ substanceStatus.VALUE_DECODE }}</md-option>
                        </md-select>
                    </md-input-container>
                </div>

                <md-toolbar>
                    <div class='md-toolbar-tools'>
                        <h2>Indentifier</h2>
                        <span flex></span>
                        <md-button class='md-icon-button' ng-click='_ctrl.addSubstanceIdentfier()'>
                            <md-icon md-svg-icon="add-circle" aria-label='Add Substance Identifier'></md-icon>
                        </md-button>
                    </div>
                </md-toolbar>
                <md-list>
                    <md-card
                    ng-repeat='it in _ctrl.selected.SUBSTANCE_IDENTIFIER track by $index' class='noright list-item-card'>
                        <div layout-gt-sm='row' flex>
                            <md-input-container class='md-block' flex>
                                <label>Identifier</label>
                                <input ng-model='it.IDENTIFIER' type="text">
                            </md-input-container>
                        </div>
                        <div layout-gt-sm='row' flex>
                            <md-input-container class="md-block" flex-gt-sm='50'>
                                <label>Type</label>
                                <md-select name="repeatSelectIdType" id="repeatSelectIdType" ng-model="it.SUBSTANCE_IDENTIFIER_TYPE.VALUE" ng-change="_ctrl.updateIdTypeDecodeByIdentifierIndex($index)">
                                    <md-option ng-repeat="idType in _ctrl.identifierTypeOptions" ng-value="idType.VALUE">{{ idType.VALUE }}</md-option>
                                </md-select>
                            </md-input-container>
                            <div flex-gt-sm="25" ng-show="it.SUBSTANCE_IDENTIFIER_TYPE.VALUE === _ctrl.getOtherValue()">
                                <md-input-container class='md-block'>
                                    <label for='subExtIdentifierTypeValueDecode'>Display Value </label>
                                    <input id='subExtIdentifierValueDecode' ng-model='it.SUBSTANCE_IDENTIFIER_TYPE.VALUE_DECODE' type="text">
                                </md-input-container>
                            </div>
                            <div flex-gt-sm="25" ng-show="it.SUBSTANCE_IDENTIFIER_TYPE.VALUE === _ctrl.getOtherValue()">
                                <md-input-container class='md-block'>
                                    <label for='subExtIdentifierTypeValue'>Encoded Value (optional)</label>
                                    <input id='subExtIdentifierTypeValue' ng-model='it.SUBSTANCE_IDENTIFIER_TYPE.ATTR_VALUE' type="text">
                                </md-input-container>
                            </div>
                        </div>
                        <div layout='row' layout-align="center center">
                            <md-button class="md-secondary md-raised " ng-click="_ctrl.deleteSubstanceIdentfier(it.IDENTIFIER, $event)">Delete</md-button>
                        </div>
                    </md-card>
                </md-list>
                <md-divider>
                    <!-- buttons -->
                    <div layout='row' layout-xs='column' layout-align='center' layout-wrap>
                        <md-button class='md-raised md-primary' ng-click='_ctrl.addSubstance()' aria-label='Add'>Add</md-button>
                        <md-button class='md-raised md-primary' ng-click='_ctrl.saveSubstance($event)' aria-label='Save'>Save</md-button>
                        <md-button class='md-raised md-primary' ng-click='_ctrl.cancelEdit()' aria-label='Cancel'>Cancel</md-button>
                        <md-button class='md-raised md-primary' ng-click='_ctrl.deleteSubstance()' aria-label='Delete'>Delete</md-button>
                    </div>
            </form>
        </md-content>

    </div>
</section>
