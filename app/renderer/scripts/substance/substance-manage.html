<div style="width:100%" layout='column'>
    <md-toolbar class="md-whiteframe-z1" layout="row">
        <div class="md-toolbar-tools">
            <md-button class="md-icon-button" aria-label="Home" ng-href="#/home">
                <md-icon class="material-icons" aria-label="Home">home</md-icon>
            </md-button>
            <h2>
          <span>Substance Management</span>
        </h2>
        </div>
    </md-toolbar>

    <div style='100%' layout='row'>
        <md-sidenav class="site-sidenav md-sidenav-left md-whiteframe-z2" md-component-id="left" md-is-locked-open="true">
            <!--  md-is-locked-open="$mdMedia('gt-sm')"-->
            <md-toolbar layout="row" class="md-whiteframe-z1">
                <md-headline layout-padding>Substances</md-headline>
            </md-toolbar>
            <md-input-container style="margin-bottom:0">
                <label>Substance Name</label>
                <input name="substanceName" ng-model="_ctrl.filterText" ng-change="_ctrl.filterSubstance()">
            </md-input-container>
            <md-list>
                <!-- notice work around for nedb. 'track by index'' to fix $$hashkey problem -->
                <md-list-item ng-repeat="it in _ctrl.substances track by $index" ng-click="_ctrl.selectSubstance(it, $index)">
                    <p>{{it.SUBSTANCE_NAME}}</p>
                </md-list-item>
            </md-list>
        </md-sidenav>
        
        <div flex layout='column' tabIndex='-1' role='main' class='md-whiteframe-z2'>
            <md-toolbar layout="row" class="md-whiteframe-z1">
                <md-headline layout-padding>{{ _ctrl.selected.SUBSTANCE_NAME }}</md-headline>
            </md-toolbar>
            <md-content layout-padding class='autoScroll'>
                <form name='substanceForm'>
                    <div layout-gt-sm='row'>
                        <md-input-container class='md-block' flex-gt-xs>
                            <label for='identifier'>Identifier</label>
                            <input ng-model='_ctrl.selected._identifier' name='identifier' type='text' disabled />
                        </md-input-container>
                    </div>
                    <div layout-gt-sm='row'>
                        <md-input-container class='md-block' flex-gt-xs>
                            <label for='name'>Name</label>
                            <input required ng-model='_ctrl.selected.SUBSTANCE_NAME' name='name' type='text' />
                        </md-input-container>
                    </div>
                    <div layout-gt-sm='row'>
                        <md-input-container class='md-block' flex-gt-xs>
                            <label for='pid'>PID</label>
                            <input ng-model='_ctrl.selected.SUBSTANCE_PID' name='pid' type='text' disabled />
                        </md-input-container>
                    </div>
                    <div layout-gt-sm='row'>
                        <md-input-container>
                            <label for='status'>Status</label>
                            <input ng-model='_ctrl.selected.METADATA_STATUS.VALUE' type='text'>
                        </md-input-container>
                    </div>

                    <md-toolbar>
                        <div class='md-toolbar-tools'>
                            <h2>Substance Indentifier</h2>
                            <span flex></span>
                            <md-button class='md-icon-button' ng-click='_ctrl.addSubstanceIdentfier()' ng-disabled='_ctrl.selectedIndex < 0'>
                                <md-icon class='material-icons' aria-label='Add Substance Identifier'>add_circle</md-icon>
                            </md-button>
                        </div>
                    </md-toolbar>
                    <md-list class='md-block' flex-gt-sm>
                        <md-list-item ng-repeat='it in _ctrl.selected.SUBSTANCE_IDENTIFIER track by $index' class='noright' flex-gt-sm>
                            <div flex layout='column' layout-gt-sm='row'>
                                <md-input-container class="md-block" flex-gt-sm>
                                    <label>Type</label>
                                    <input ng-model='it.SUBSTANCE_IDENTIFIER_TYPE.VALUE_DECODE' type='text'>
                                </md-input-container>
                                <md-input-container class='md-block' flex-gt-sm>
                                    <label>Identifier</label>
                                    <input ng-model='it.IDENTIFIER' type="text">
                                </md-input-container>
                                <md-button class="md-icon-button" ng-click="_ctrl.deleteSubstanceIdentfier($index, $event)">
                                    <md-icon class="material-icons" aria-label="Delete Substance Identifier">remove_circle_outline</md-icon>
                                </md-button>
                            </div>
                        </md-list-item>
                    </md-list>
                </form>
            </md-content>

            <!-- buttons -->
            <section layout='row' layout-sm='column' layout-align='center' layout-wrap>
                <md-button class='md-raised md-info' ng-click='_ctrl.addSubstance()' aria-label='Add' >Add</md-button>                                
                <md-button class='md-raised md-primary' ng-click='_ctrl.saveSubstance()' aria-label='Save' ng-disabled="substanceForm.$invalid">Save</md-button>
                <md-button class='md-raised md-danger' ng-click='_ctrl.cancelEdit()' aria-label='Cancel' >Cancel</md-button>
                <md-button class='md-raised md-warn' ng-click='_ctrl.deleteSubstance()' aria-label='Delete' >Delete</md-button>      
                <md-button class='md-raised md-warn' ng-click='_ctrl.initializeSubstances()' aria-label='init DB'>Initialize DB with sample</md-button>
            </section>
        </div>
    </div>
</div>